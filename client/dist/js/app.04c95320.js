(function(e){function t(t){for(var n,i,s=t[0],c=t[1],l=t[2],d=0,p=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(p.length)p.shift()();return a.push.apply(a,l||[]),o()}function o(){for(var e,t=0;t<a.length;t++){for(var o=a[t],n=!0,s=1;s<o.length;s++){var c=o[s];0!==r[c]&&(n=!1)}n&&(a.splice(t--,1),e=i(i.s=o[0]))}return e}var n={},r={app:0},a=[];function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=n,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;a.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},1:function(e,t){},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("2b0e"),r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("BlockGame")],1)},a=[],i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticStyle:{float:"left"}},[o("canvas",{staticStyle:{border:"1px solid black"},attrs:{id:"game-canvas",width:"640",height:"480"},on:{mousemove:e.movePlayerByMouseMove}}),o("p",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.player.name,expression:"player.name"}],attrs:{type:"text",disabled:""},domProps:{value:e.player.name},on:{input:function(t){t.target.composing||e.$set(e.player,"name",t.target.value)}}})]),o("p",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.messageText,expression:"messageText"}],attrs:{type:"text"},domProps:{value:e.messageText},on:{focus:function(t){return e.toggleWindowKeyDown(!1)},blur:function(t){return e.toggleWindowKeyDown(!0)},input:function(t){t.target.composing||(e.messageText=t.target.value)}}}),o("button",{on:{click:function(t){return e.sendMessage()}}},[e._v("Send")])]),o("p",[o("button",{on:{click:function(t){return e.movePlayer("right")}}},[e._v("Right")]),o("button",{on:{click:function(t){return e.movePlayer("left")}}},[e._v("Left")]),o("button",{on:{click:function(t){return e.movePlayer("up")}}},[e._v("Up")]),o("button",{on:{click:function(t){return e.movePlayer("down")}}},[e._v("Down")])])]),o("div",{staticStyle:{float:"left","margin-left":"20px",border:"1px solid black",width:"640px",height:"480px"}},e._l(e.chat,(function(t){return o("div",{key:t.id},[o("p",[e._v(e._s(t.player.name)+": "+e._s(t.text))])])})),0)])},s=[],c=(o("7db0"),o("4160"),o("d3b7"),o("ac1f"),o("3ca3"),o("841c"),o("159b"),o("ddb0"),o("2b3d"),o("8055")),l=o.n(c),u=o("ec26"),d={paramName:"BlockGame",data:function(){return{socket:{},context:{},player:{},players:[],messageText:"",chat:[]}},created:function(){this.socket=l()("http://localhost:3000"),this.socket.on("playersLoaded",this.playersLoaded),this.socket.on("chatHistoryLoaded",this.chatHistoryLoaded),this.socket.on("playerMoved",this.playerMoved),this.socket.on("messageLoaded",this.messageLoaded),window.addEventListener("keydown",this.movePlayerWithKeyboard),this.init()},mounted:function(){this.context=document.querySelector("#game-canvas").getContext("2d")},methods:{init:function(){this.loadPlayers(),this.loadChatHistory()},loadPlayers:function(){this.socket.emit("loadPlayers")},setupCurrentPlayer:function(){var e=this.getUrlParameter("playerToken");if(this.player=this.players.find((function(t){return t.token===e})),!this.player)throw new Error("No player found for token "+e)},loadChatHistory:function(){this.socket.emit("loadChatHistory")},playersLoaded:function(e){this.players=e,this.setupCurrentPlayer(),this.drawPlayers()},chatHistoryLoaded:function(e){this.chat=e},drawPlayers:function(e){var t=this;this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.players.forEach((function(o){e&&o.id===e.id&&(o.coordinates=e.coordinates),t.context.fillStyle=o.color,t.context.fillRect(o.coordinates.x,o.coordinates.y,20,20)}))},movePlayer:function(e){var t={option:"direction",player:this.player,direction:e};this.socket.emit("movePlayer",t)},movePlayerByMouseMove:function(e){var t={option:"coordinates",player:this.player,coordinates:{x:e.pageX,y:e.pageY}};this.socket.emit("movePlayer",t)},playerMoved:function(e){this.drawPlayers(e)},movePlayerWithKeyboard:function(e){switch(String.fromCharCode(e.keyCode)){case"A":this.movePlayer("left");break;case"D":this.movePlayer("right");break;case"W":this.movePlayer("up");break;case"S":this.movePlayer("down");break}},getUrlParameter:function(e){var t=new URLSearchParams(location.search);return t.get(e)},sendMessage:function(){var e={id:Object(u["a"])(),player:this.player,text:this.messageText};this.socket.emit("sendMessage",e),this.messageText=""},messageLoaded:function(e){this.chat.push(e)},toggleWindowKeyDown:function(e){!0===e?window.addEventListener("keydown",this.movePlayerWithKeyboard):window.removeEventListener("keydown",this.movePlayerWithKeyboard)}}},p=d,h=o("2877"),y=Object(h["a"])(p,i,s,!1,null,null,null),f=y.exports,m={name:"app",components:{BlockGame:f}},v=m,g=Object(h["a"])(v,r,a,!1,null,null,null),b=g.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(e){return e(b)}}).$mount("#app")}});
//# sourceMappingURL=app.04c95320.js.map